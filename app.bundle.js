/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var e,t,n={255:(e,t,n)=>{n.d(t,{A:()=>o});var r={BASE_URL:"https://story-api.dicoding.dev/v1",AUTH_TOKEN:"",VAPID_PUBLIC_KEY:"BDXMq-v6e3Y6Dof9ON_OZaR1xj-ydByyJLvwgVqaiGJDAm391rRNZj6eBJCkMh14_q3Cl2-tLI4Z_06ChpdFFHc",MAP:{TILE_URL:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",ATTRIBUTION:"&copy; OpenStreetMap contributors"}};console.log("[CONFIG] Module loaded. VAPID_PUBLIC_KEY:",r.VAPID_PUBLIC_KEY?r.VAPID_PUBLIC_KEY.substring(0,20)+"...":"MISSING");const o=r},652:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return(t=function(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function s(){var e=y(),t=e.m(s),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,l(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(s=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new h(e,t)},AsyncIterator:v,async:function(e,t,n,o,i){return(r(t)?d:p)(a(e),t,n,o,i)},keys:f,values:l}})()}function l(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")}function f(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function p(e,t,n,r,o){var a=d(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function d(e,t,n,r,o){return new v(y().w(e,t,n,r),o||Promise)}function v(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof h?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(m(v.prototype),m(v.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),m(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function y(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return m(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(m(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,m(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,m(f,"constructor",s),m(s,"constructor",u),u.displayName="GeneratorFunction",m(s,o,"GeneratorFunction"),m(f),m(f,o,"Generator"),m(f,r,(function(){return this})),m(f,"toString",(function(){return"[object Generator]"})),(y=function(){return{w:a,m:p}})()}function m(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}m=function(e,t,n,r){function a(t,n){m(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},m(e,t,n,r)}function h(e,t){this.v=e,this.k=t}function b(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){b(a,r,o,i,c,"next",e)}function c(e){b(a,r,o,i,c,"throw",e)}i(void 0)}))}}function x(){return k.apply(this,arguments)}function k(){return k=g(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n=indexedDB.open("StoryAppDB",2);n.onerror=function(){return t(n.error)},n.onsuccess=function(){return e(n.result)},n.onupgradeneeded=function(e){var t=e.target.result,n=e.oldVersion;if(!t.objectStoreNames.contains("offlineStories")){var r=t.createObjectStore("offlineStories",{keyPath:"id"});r.createIndex("synced","synced",{unique:!1}),r.createIndex("createdAt","createdAt",{unique:!1})}if(t.objectStoreNames.contains("cachedStories")||t.createObjectStore("cachedStories",{keyPath:"id",autoIncrement:!1}).createIndex("timestamp","timestamp",{unique:!1}),t.objectStoreNames.contains("favorites")){if(n<2){var o=e.target.transaction.objectStore("favorites");o.indexNames.contains("savedAt")||o.createIndex("savedAt","savedAt",{unique:!1})}}else t.createObjectStore("favorites",{keyPath:"id",autoIncrement:!1}).createIndex("savedAt","savedAt",{unique:!1})}})));case 1:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function w(){return S.apply(this,arguments)}function S(){return S=g(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return t=e.sent,n=t.transaction("offlineStories","readonly"),r=n.objectStore("offlineStories"),e.abrupt("return",new Promise((function(e,t){var n=r.getAll();n.onsuccess=function(){return e(n.result||[])},n.onerror=function(){return t(n.error)}})));case 9:return e.prev=9,e.t0=e.catch(0),console.error("Error getting offline stories:",e.t0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),S.apply(this,arguments)}function P(){return T.apply(this,arguments)}function T(){return T=g(s().mark((function e(){var t,n,r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return t=e.sent,n=t.transaction("offlineStories","readonly"),r=n.objectStore("offlineStories"),e.next=8,new Promise((function(e,t){var n=r.getAll();n.onsuccess=function(){return e(n.result||[])},n.onerror=function(){return t(n.error)}}));case 8:return o=e.sent,e.abrupt("return",o.filter((function(e){return!1===e.synced||!e.synced})));case 12:return e.prev=12,e.t0=e.catch(0),console.error("Error getting unsynced stories:",e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),T.apply(this,arguments)}function O(e){return E.apply(this,arguments)}function E(){return E=g(s().mark((function e(t){var n,r,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return n=e.sent,r=n.transaction("offlineStories","readwrite"),o=r.objectStore("offlineStories"),e.next=8,new Promise((function(e,n){var r=o.get(t);r.onsuccess=function(){return e(r.result)},r.onerror=function(){return n(r.error)}}));case 8:if(!(a=e.sent)){e.next=13;break}return a.synced=!0,e.next=13,new Promise((function(e,t){var n=o.put(a);n.onsuccess=function(){return e()},n.onerror=function(){return t(n.error)}}));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error("Error marking story as synced:",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),E.apply(this,arguments)}function A(e){return j.apply(this,arguments)}function j(){return j=g(s().mark((function e(t){var n,r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return n=e.sent,r=n.transaction("offlineStories","readwrite"),o=r.objectStore("offlineStories"),e.next=8,new Promise((function(e,n){var r=o.delete(t);r.onsuccess=function(){return e()},r.onerror=function(){return n(r.error)}}));case 8:e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),console.error("Error deleting story:",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])}))),j.apply(this,arguments)}function I(e){return L.apply(this,arguments)}function L(){return L=g(s().mark((function e(t){var n,r,o,i,u,l,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return n=e.sent,r=n.transaction("cachedStories","readwrite"),o=r.objectStore("cachedStories"),e.next=8,new Promise((function(e,t){var n=o.clear();n.onsuccess=function(){return e()},n.onerror=function(){return t(n.error)}}));case 8:i=Date.now(),u=c(t),e.prev=10,f=s().mark((function e(){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.value,e.next=3,new Promise((function(e,n){var r=o.add(a(a({},t),{},{timestamp:i}));r.onsuccess=function(){return e()},r.onerror=function(){return n(r.error)}}));case 3:case"end":return e.stop()}}),e)})),u.s();case 13:if((l=u.n()).done){e.next=17;break}return e.delegateYield(f(),"t0",15);case 15:e.next=13;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(10),u.e(e.t1);case 22:return e.prev=22,u.f(),e.finish(22);case 25:e.next=30;break;case 27:e.prev=27,e.t2=e.catch(0),console.error("Error caching stories:",e.t2);case 30:case"end":return e.stop()}}),e,null,[[0,27],[10,19,22,25]])}))),L.apply(this,arguments)}function _(){return N.apply(this,arguments)}function N(){return N=g(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return t=e.sent,n=t.transaction("cachedStories","readonly"),r=n.objectStore("cachedStories"),e.abrupt("return",new Promise((function(e,t){var n=r.getAll();n.onsuccess=function(){return e(n.result||[])},n.onerror=function(){return t(n.error)}})));case 9:return e.prev=9,e.t0=e.catch(0),console.error("Error getting cached stories:",e.t0),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[0,9]])}))),N.apply(this,arguments)}function F(e){return B.apply(this,arguments)}function B(){return B=g(s().mark((function e(t){var n,r,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return n=e.sent,r=n.transaction("offlineStories","readwrite"),o=r.objectStore("offlineStories"),a={id:t.id||Date.now().toString(),description:t.description,photo:t.photo,photoName:t.photoName||"photo.jpg",photoType:t.photoType||"image/jpeg",lat:t.lat||null,lon:t.lon||null,createdAt:t.createdAt||(new Date).toISOString(),synced:t.synced||!1},e.next=9,new Promise((function(e,t){var n=o.add(a);n.onsuccess=function(){return e()},n.onerror=function(){return t(n.error)}}));case 9:return e.abrupt("return",a);case 12:throw e.prev=12,e.t0=e.catch(0),console.error("Error adding offline story:",e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),B.apply(this,arguments)}function C(e){return G.apply(this,arguments)}function G(){return G=g(s().mark((function e(t){var n,r,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:if((n=e.sent).objectStoreNames.contains("favorites")){e.next=7;break}throw console.error("[indexeddb] Favorites store does not exist. DB may need upgrade."),new Error("Favorites store tidak tersedia. Silakan refresh halaman.");case 7:return r=n.transaction("favorites","readwrite"),o=r.objectStore("favorites"),a={id:t.id,name:t.name||"",description:t.description||"",photoUrl:t.photoUrl||t.photo||"",createdAt:t.createdAt||(new Date).toISOString(),lat:t.lat||null,lon:t.lon||null,savedAt:(new Date).toISOString()},e.next=12,new Promise((function(e,t){var n=o.put(a);n.onsuccess=function(){return e()},n.onerror=function(){return t(n.error)}}));case 12:return e.abrupt("return",a);case 15:throw e.prev=15,e.t0=e.catch(0),console.error("Error adding favorite:",e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])}))),G.apply(this,arguments)}function M(e){return D.apply(this,arguments)}function D(){return D=g(s().mark((function e(t){var n,r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:if((n=e.sent).objectStoreNames.contains("favorites")){e.next=7;break}return console.warn("[indexeddb] Favorites store does not exist"),e.abrupt("return");case 7:return r=n.transaction("favorites","readwrite"),o=r.objectStore("favorites"),e.abrupt("return",new Promise((function(e,n){var r=o.delete(t);r.onsuccess=function(){e()},r.onerror=function(){console.error("[indexeddb] Error in removeFavorite request:",r.error),n(r.error)}})));case 12:throw e.prev=12,e.t0=e.catch(0),console.error("Error removing favorite:",e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),D.apply(this,arguments)}function H(e){return U.apply(this,arguments)}function U(){return U=g(s().mark((function e(t){var n,r,o,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:if((n=e.sent).objectStoreNames.contains("favorites")){e.next=6;break}return e.abrupt("return",!1);case 6:return r=n.transaction("favorites","readonly"),o=r.objectStore("favorites"),e.next=10,new Promise((function(e,n){var r=o.get(t);r.onsuccess=function(){return e(r.result)},r.onerror=function(){return n(r.error)}}));case 10:return a=e.sent,e.abrupt("return",!!a);case 14:return e.prev=14,e.t0=e.catch(0),console.error("Error checking favorite:",e.t0),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),U.apply(this,arguments)}function q(){return R.apply(this,arguments)}function R(){return R=g(s().mark((function e(){var t,n,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:if((t=e.sent).objectStoreNames.contains("favorites")){e.next=7;break}return console.warn("[indexeddb] Favorites store does not exist yet"),e.abrupt("return",[]);case 7:return n=t.transaction("favorites","readonly"),o=n.objectStore("favorites"),e.abrupt("return",new Promise((function(e,t){var n=o.getAll();n.onsuccess=function(){try{var t=n.result;if(t)if(Array.isArray(t))e(t);else if(console.warn("[indexeddb] getAllFavorites returned non-array:",r(t),t),"object"===r(t)&&null!==t){var o=Object.values(t);e(Array.isArray(o)?o:[])}else e([]);else e([])}catch(t){console.error("[indexeddb] Error processing getAllFavorites result:",t),e([])}},n.onerror=function(){console.error("[indexeddb] Error in getAllFavorites request:",n.error),e([])}})));case 12:return e.prev=12,e.t0=e.catch(0),console.error("[indexeddb] Error getting favorites:",e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),R.apply(this,arguments)}n.r(t),n.d(t,{addFavorite:()=>C,addOfflineStory:()=>F,cacheStories:()=>I,deleteStory:()=>A,getAllFavorites:()=>q,getAllOfflineStories:()=>w,getCachedStories:()=>_,getUnsyncedStories:()=>P,isFavorite:()=>H,markStoryAsSynced:()=>O,openDB:()=>x,removeFavorite:()=>M})}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e](a,a.exports,o),a.exports}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(){var e=p(),t=e.m(i),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,c(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(i=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new v(e,t)},AsyncIterator:f,async:function(e,t,n,o,i){return(r(t)?l:s)(a(e),t,n,o,i)},keys:u,values:c}})()}function c(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(a(e)+" is not iterable")}function u(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function s(e,t,n,r,o){var a=l(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function l(e,t,n,r,o){return new f(p().w(e,t,n,r),o||Promise)}function f(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof v?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(d(f.prototype),d(f.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),d(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function p(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return d(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(d(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,d(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,d(f,"constructor",s),d(s,"constructor",u),u.displayName="GeneratorFunction",d(s,o,"GeneratorFunction"),d(f),d(f,o,"Generator"),d(f,r,(function(){return this})),d(f,"toString",(function(){return"[object Generator]"})),(p=function(){return{w:a,m:v}})()}function d(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}d=function(e,t,n,r){function a(t,n){d(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},d(e,t,n,r)}function v(e,t){this.v=e,this.k=t}function y(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}o.m=n,o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>e+".bundle.js",o.miniCssF=e=>{},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="app-starter-project-with-webpack:",o.l=(n,r,a,i)=>{if(e[n])e[n].push(r);else{var c,u;if(void 0!==a)for(var s=document.getElementsByTagName("script"),l=0;l<s.length;l++){var f=s[l];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==t+a){c=f;break}}c||(u=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.setAttribute("data-webpack",t+a),c.src=n),e[n]=[r];var p=(t,r)=>{c.onerror=c.onload=null,clearTimeout(d);var o=e[n];if(delete e[n],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach((e=>e(r))),t)return t(r)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=p.bind(null,c.onerror),c.onload=p.bind(null,c.onload),u&&document.head.appendChild(c)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="/Tugas-intermediate-idelia-fk/",(()=>{var e={524:0};o.f.j=(t,n)=>{var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var a=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=a);var i=o.p+o.u(t),c=new Error;o.l(i,(n=>{if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,r[1](c)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,a,[i,c,u]=n,s=0;if(i.some((t=>0!==e[t]))){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);u&&u(o)}for(t&&t(n);s<i.length;s++)a=i[s],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();const m=function(){var e,t=(e=i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'\n    <section class="container">\n      <h1>Tentang Story App</h1>\n      <p>Story App adalah aplikasi web untuk berbagi cerita dengan lokasi. Aplikasi ini memungkinkan pengguna untuk menambahkan cerita mereka dengan foto dan lokasi GPS.</p>\n      \n      <h2>Fitur Utama</h2>\n      <ul style="margin-left: 20px; line-height: 1.8;">\n        <li><strong>Berbagi Cerita:</strong> Tambahkan cerita dengan foto dan deskripsi</li>\n        <li><strong>Lokasi GPS:</strong> Sertakan lokasi GPS untuk setiap cerita</li>\n        <li><strong>Peta Interaktif:</strong> Lihat semua cerita di peta dengan markers</li>\n        <li><strong>Mode Offline:</strong> Simpan cerita secara offline dan sinkronisasi saat online</li>\n        <li><strong>Push Notification:</strong> Dapatkan notifikasi untuk cerita baru</li>\n        <li><strong>PWA:</strong> Install aplikasi sebagai Progressive Web App</li>\n      </ul>\n      \n      <h2>Teknologi</h2>\n      <p>Aplikasi ini dibangun menggunakan teknologi web modern:</p>\n      <ul style="margin-left: 20px; line-height: 1.8;">\n        <li>HTML5, CSS3, JavaScript (ES6+)</li>\n        <li>Webpack untuk bundling</li>\n        <li>Leaflet.js untuk peta interaktif</li>\n        <li>IndexedDB untuk penyimpanan offline</li>\n        <li>Service Worker untuk PWA dan offline support</li>\n        <li>Web Push API untuk push notifications</li>\n      </ul>\n    </section>\n  ');case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){y(a,r,o,i,c,"next",e)}function c(e){y(a,r,o,i,c,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();var h=o(255);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(){var e=T(),t=e.m(g),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,x(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(g=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new E(e,t)},AsyncIterator:P,async:function(e,t,n,o,i){return(r(t)?S:w)(a(e),t,n,o,i)},keys:k,values:x}})()}function x(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(b(e)+" is not iterable")}function k(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function w(e,t,n,r,o){var a=S(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function S(e,t,n,r,o){return new P(T().w(e,t,n,r),o||Promise)}function P(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof E?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(O(P.prototype),O(P.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),O(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function T(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return O(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(O(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,O(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,O(f,"constructor",s),O(s,"constructor",u),u.displayName="GeneratorFunction",O(s,o,"GeneratorFunction"),O(f),O(f,o,"Generator"),O(f,r,(function(){return this})),O(f,"toString",(function(){return"[object Generator]"})),(T=function(){return{w:a,m:p}})()}function O(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}O=function(e,t,n,r){function a(t,n){O(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},O(e,t,n,r)}function E(e,t){this.v=e,this.k=t}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return(t=function(e){var t=function(e){if("object"!=b(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){_(a,r,o,i,c,"next",e)}function c(e){_(a,r,o,i,c,"throw",e)}i(void 0)}))}}var F=((null===h.A||void 0===h.A?void 0:h.A.BASE_URL)||"https://story-api.dicoding.dev/v1").replace(/\/+$/,"");function B(e){return C.apply(this,arguments)}function C(){return C=N(g().mark((function e(t){var n,r,o,a,i,c,u,s,l,f,p=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=p.length>1&&void 0!==p[1]?p[1]:{}).method,o=void 0===r?"GET":r,a=n.headers,i=void 0===a?{}:a,c=n.body,u=(null===h.A||void 0===h.A?void 0:h.A.AUTH_TOKEN)||localStorage.getItem("authToken"),s=j({"Content-Type":"application/json"},i),u&&(s.Authorization="Bearer ".concat(u)),e.next=6,fetch("".concat(F).concat(t),{method:o,headers:s,body:c});case 6:return l=e.sent,e.next=9,l.json().catch((function(){return{}}));case 9:if(f=e.sent,l.ok&&!f.error){e.next=12;break}throw new Error(f.message||"HTTP ".concat(l.status));case 12:return e.abrupt("return",f);case 13:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function G(){return(G=N(g().mark((function e(t){var n,r,o,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.password,e.next=3,fetch("".concat(F,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return o=e.sent,e.next=6,o.json().catch((function(){return{}}));case 6:if(a=e.sent,o.ok&&!a.error){e.next=9;break}throw new Error(a.message||"HTTP ".concat(o.status));case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=N(g().mark((function e(t){var n,r,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,r=t.email,o=t.password,e.abrupt("return",B("/register",{method:"POST",body:JSON.stringify({name:n,email:r,password:o})}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return D=N(g().mark((function e(){var t,n,r,o,a,i,c,u,s,l,f=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=f.length>0&&void 0!==f[0]?f[0]:{}).page,r=void 0===n?1:n,o=t.size,a=void 0===o?10:o,i=t.location,c=void 0===i?1:i,(u=new URL("".concat(F,"/stories"))).searchParams.set("page",r),u.searchParams.set("size",a),null!=c&&u.searchParams.set("location",c),e.next=7,fetch(u.toString(),{headers:{Authorization:"Bearer ".concat((null===h.A||void 0===h.A?void 0:h.A.AUTH_TOKEN)||localStorage.getItem("authToken"))}});case 7:return s=e.sent,e.next=10,s.json().catch((function(){return{}}));case 10:if(l=e.sent,s.ok&&!l.error){e.next=13;break}throw new Error(l.message||"HTTP ".concat(s.status));case 13:return e.abrupt("return",l);case 14:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function H(){return H=N(g().mark((function e(t){var n,r,o,a,i,c,u,s,l;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.description,r=t.photo,o=t.lat,a=t.lon,i=(null===h.A||void 0===h.A?void 0:h.A.AUTH_TOKEN)||localStorage.getItem("authToken"),c=(null===h.A||void 0===h.A?void 0:h.A.BASE_URL)||"https://story-api.dicoding.dev/v1",(u=new FormData).append("description",n),u.append("photo",r),null!=o&&null!=a&&(u.append("lat",o),u.append("lon",a)),e.next=9,fetch("".concat(c,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(i)},body:u});case 9:return s=e.sent,e.next=12,s.json().catch((function(){return{}}));case 12:if(l=e.sent,s.ok&&!l.error){e.next=15;break}throw new Error(l.message||"HTTP ".concat(s.status));case 15:return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}const U={login:function(e){return G.apply(this,arguments)},register:function(e){return M.apply(this,arguments)},getStories:function(){return D.apply(this,arguments)},addStory:function(e){return H.apply(this,arguments)}};var q=o(652);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function z(){var e=Z(),t=e.m(z),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,V(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(z=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new X(e,t)},AsyncIterator:J,async:function(e,t,n,o,i){return(r(t)?W:Y)(a(e),t,n,o,i)},keys:K,values:V}})()}function V(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(R(e)+" is not iterable")}function K(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Y(e,t,n,r,o){var a=W(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function W(e,t,n,r,o){return new J(Z().w(e,t,n,r),o||Promise)}function J(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof X?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||($(J.prototype),$(J.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),$(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function Z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return $(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):($(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,$(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,$(f,"constructor",s),$(s,"constructor",u),u.displayName="GeneratorFunction",$(s,o,"GeneratorFunction"),$(f),$(f,o,"Generator"),$(f,r,(function(){return this})),$(f,"toString",(function(){return"[object Generator]"})),(Z=function(){return{w:a,m:p}})()}function $(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}$=function(e,t,n,r){function a(t,n){$(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},$(e,t,n,r)}function X(e,t){this.v=e,this.k=t}function Q(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ee(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Q(a,r,o,i,c,"next",e)}function c(e){Q(a,r,o,i,c,"throw",e)}i(void 0)}))}}function te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ne(r.key),r)}}function ne(e){var t=function(e){if("object"!=R(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==R(t)?t:t+""}function re(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var oe=new WeakSet,ae=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,oe)},t=[{key:"render",value:(r=ee(z().mark((function e(){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'\n      <section class="container">\n        <h1>Tambah Story Baru</h1>\n        \n        <div id="addNotice" class="notice" aria-live="polite"></div>\n        \n        <form id="addStoryForm" class="form-add" novalidate>\n          <div class="form-group">\n            <label for="description">Deskripsi Story</label>\n            <textarea \n              id="description" \n              name="description" \n              rows="4" \n              required \n              placeholder="Tuliskan deskripsi story Anda..."\n              aria-required="true"></textarea>\n          </div>\n          \n          <div class="form-group" style="margin-top:12px">\n            <label for="photo">Foto</label>\n            <input \n              type="file" \n              id="photo" \n              name="photo" \n              accept="image/*" \n              required \n              aria-required="true"\n              aria-describedby="photoHelp" />\n            <small id="photoHelp" style="display:block;margin-top:4px;color:#666">\n              Format yang didukung: JPG, PNG, GIF. Maksimal 1MB.\n            </small>\n          </div>\n          \n          <div class="form-group" style="margin-top:12px">\n            <label for="includeLocation">\n              <input type="checkbox" id="includeLocation" />\n              Sertakan lokasi GPS\n            </label>\n            <small style="display:block;margin-top:4px;color:#666">\n              Centang untuk menambahkan koordinat GPS. Pilih lokasi dengan klik di peta atau gunakan GPS saat ini.\n            </small>\n          </div>\n          \n          <div id="locationPicker" style="display:none;margin-top:12px">\n            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">\n              <label style="font-weight:bold">Pilih Lokasi di Peta:</label>\n              <button type="button" id="useCurrentLocation" style="padding:6px 12px;background:#4caf50;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:12px">\n                Gunakan Lokasi Saat Ini\n              </button>\n            </div>\n            <div id="locationMap" style="height:300px;width:100%;border:2px solid #ddd;border-radius:8px;margin-bottom:8px"></div>\n            <div id="locationInfo" style="padding:8px;background:#e3f2fd;border-radius:6px">\n              <small><strong>Koordinat yang dipilih:</strong> <span id="currentLatLon">Belum dipilih. Klik di peta untuk memilih lokasi.</span></small>\n            </div>\n          </div>\n          \n          <button type="submit" id="submitBtn" style="margin-top:16px" aria-label="Simpan story baru">\n            Simpan Story\n          </button>\n        </form>\n        \n        <div id="offlineStories" style="margin-top:24px">\n          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">\n            <h2 style="margin:0">Story Offline (Belum Tersinkronisasi)</h2>\n            <button \n              id="syncBtn" \n              style="padding:6px 12px;background:#6c63ff;color:#fff;border:none;border-radius:6px;cursor:pointer"\n              aria-label="Sinkronisasi story offline">\n              Sinkronisasi\n            </button>\n          </div>\n          \n          \x3c!-- Filter, Sort, Search Controls --\x3e\n          <div style="margin-bottom:16px;padding:12px;background:#f5f5f5;border-radius:8px">\n            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:8px">\n              <div>\n                <label for="searchOffline" style="display:block;margin-bottom:4px;font-size:14px;font-weight:bold">Cari:</label>\n                <input \n                  type="text" \n                  id="searchOffline" \n                  placeholder="Cari deskripsi..." \n                  style="width:100%;padding:6px;border:1px solid #ddd;border-radius:4px"\n                  aria-label="Cari story offline">\n              </div>\n              <div>\n                <label for="sortOffline" style="display:block;margin-bottom:4px;font-size:14px;font-weight:bold">Urutkan:</label>\n                <select \n                  id="sortOffline" \n                  style="width:100%;padding:6px;border:1px solid #ddd;border-radius:4px"\n                  aria-label="Urutkan story offline">\n                  <option value="newest">Terbaru</option>\n                  <option value="oldest">Terlama</option>\n                  <option value="description-asc">Deskripsi A-Z</option>\n                  <option value="description-desc">Deskripsi Z-A</option>\n                </select>\n              </div>\n              <div>\n                <label for="filterOffline" style="display:block;margin-bottom:4px;font-size:14px;font-weight:bold">Filter:</label>\n                <select \n                  id="filterOffline" \n                  style="width:100%;padding:6px;border:1px solid #ddd;border-radius:4px"\n                  aria-label="Filter story offline">\n                  <option value="all">Semua</option>\n                  <option value="with-location">Dengan Lokasi</option>\n                  <option value="no-location">Tanpa Lokasi</option>\n                </select>\n              </div>\n            </div>\n            <div id="offlineStats" style="font-size:12px;color:#666;margin-top:8px"></div>\n          </div>\n          \n          <div id="offlineList" role="list" aria-label="Daftar story offline"></div>\n        </div>\n      </section>\n    ');case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=ee(z().mark((function e(){var t,n,r,a,i,c,u,s,l,f,p,d,v,y,m,b,g=this;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("addStoryForm"),n=document.getElementById("submitBtn"),r=document.getElementById("addNotice"),a=document.getElementById("photo"),i=document.getElementById("includeLocation"),c=document.getElementById("locationInfo"),document.getElementById("offlineList"),t&&n&&r){e.next=9;break}return e.abrupt("return");case 9:if(localStorage.getItem("authToken")){e.next=14;break}return r.innerHTML='<p>Silakan <a href="#/login">login</a> terlebih dahulu untuk menambah story.</p>',t.style.display="none",e.abrupt("return");case 14:return u=null,s=null,l=null,f=document.getElementById("currentLatLon"),p=function(e){s&&(l&&s.removeLayer(l),(l=L.marker(e,{draggable:!0,title:"Lokasi yang dipilih"}).addTo(s)).on("dragend",(function(e){var t=e.target.getLatLng(),n=t.lat,r=t.lng;u={lat:n,lon:r},f&&(f.textContent="".concat(n.toFixed(6),", ").concat(r.toFixed(6)))})),l.bindPopup("Lokasi: ".concat(e[0].toFixed(6),", ").concat(e[1].toFixed(6))).openPopup())},i&&i.addEventListener("change",function(){var e=ee(z().mark((function e(t){var n,o,a,i,c,d,v,y;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=document.getElementById("locationPicker"),o=document.getElementById("locationMap"),a=document.getElementById("useCurrentLocation"),!t.target.checked){e.next=23;break}if(n.style.display="block",s||!o||"undefined"==typeof L){e.next=20;break}return d=[-2.5489,118.0149],s=L.map(o).setView(d,5),L.tileLayer((null===h.A||void 0===h.A||null===(i=h.A.MAP)||void 0===i?void 0:i.TILE_URL)||"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:(null===h.A||void 0===h.A||null===(c=h.A.MAP)||void 0===c?void 0:c.ATTRIBUTION)||"&copy; OpenStreetMap"}).addTo(s),e.prev=9,e.next=12,re(oe,g,ie).call(g);case 12:(v=e.sent)&&(s.setView([v.lat,v.lon],13),u=v,p([v.lat,v.lon]),f&&(f.textContent="".concat(v.lat.toFixed(6),", ").concat(v.lon.toFixed(6)))),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.warn("[add] Could not get current location:",e.t0);case 19:s.on("click",(function(e){var t=e.latlng,n=t.lat,r=t.lng;u={lat:n,lon:r},p([n,r]),f&&(f.textContent="".concat(n.toFixed(6),", ").concat(r.toFixed(6)))}));case 20:a&&(y=a.cloneNode(!0),a.parentNode.replaceChild(y,a),y.addEventListener("click",ee(z().mark((function e(){var t;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re(oe,g,ie).call(g);case 3:(t=e.sent)&&s&&(s.setView([t.lat,t.lon],13),u=t,p([t.lat,t.lon]),f&&(f.textContent="".concat(t.lat.toFixed(6),", ").concat(t.lon.toFixed(6))),r.textContent=""),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),r.innerHTML='<p class="error">Gagal mengambil lokasi: '.concat(e.t0.message,"</p>");case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))))),e.next=26;break;case 23:n.style.display="none",u=null,l&&(s.removeLayer(l),l=null);case 26:case"end":return e.stop()}}),e,null,[[9,16]])})));return function(t){return e.apply(this,arguments)}}()),t.addEventListener("submit",function(){var e=ee(z().mark((function e(o){var f,p,d,v;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.preventDefault(),p=document.getElementById("description").value.trim(),d=null==a||null===(f=a.files)||void 0===f?void 0:f[0],p&&d){e.next=6;break}return r.innerHTML='<p class="error">Deskripsi dan foto wajib diisi.</p>',e.abrupt("return");case 6:if(!(d.size>1048576)){e.next=9;break}return r.innerHTML='<p class="error">Ukuran foto maksimal 1MB.</p>',e.abrupt("return");case 9:if(n.disabled=!0,r.textContent="Menyimpan story...",r.setAttribute("aria-busy","true"),v={description:p,photo:d,lat:null!=i&&i.checked&&u?u.lat:null,lon:null!=i&&i.checked&&u?u.lon:null},s&&l&&(s.removeLayer(l),l=null),e.prev=14,!navigator.onLine){e.next=27;break}return e.next=18,re(oe,g,ue).call(g,v);case 18:return r.innerHTML='<p style="color:green">Story berhasil disimpan!</p>',t.reset(),c.style.display="none",u=null,e.next=24,re(oe,g,pe).call(g);case 24:setTimeout((function(){location.hash="#/home"}),1500),e.next=35;break;case 27:return e.next=29,re(oe,g,le).call(g,v);case 29:return r.innerHTML='<p style="color:orange">Story disimpan offline. Akan disinkronisasi saat online.</p>',t.reset(),c.style.display="none",u=null,e.next=35,re(oe,g,pe).call(g);case 35:e.next=58;break;case 37:if(e.prev=37,e.t0=e.catch(14),console.error("[add] error:",e.t0),!(navigator.onLine&&e.t0.message.includes("network")||e.t0.message.includes("fetch"))){e.next=57;break}return e.prev=41,e.next=44,re(oe,g,le).call(g,v);case 44:return r.innerHTML='<p style="color:orange">Gagal menyimpan online. Story disimpan offline untuk sinkronisasi nanti.</p>',t.reset(),c.style.display="none",u=null,e.next=50,re(oe,g,pe).call(g);case 50:e.next=55;break;case 52:e.prev=52,e.t1=e.catch(41),r.innerHTML='<p class="error">Gagal menyimpan: '.concat(e.t0.message,"</p>");case 55:e.next=58;break;case 57:r.innerHTML='<p class="error">Gagal menyimpan: '.concat(e.t0.message,"</p>");case 58:return e.prev=58,n.disabled=!1,r.removeAttribute("aria-busy"),e.finish(58);case 62:case"end":return e.stop()}}),e,null,[[14,37,58,62],[41,52]])})));return function(t){return e.apply(this,arguments)}}()),e.next=23,re(oe,this,pe).call(this);case 23:d=document.getElementById("searchOffline"),v=document.getElementById("sortOffline"),y=document.getElementById("filterOffline"),m=function(){re(oe,g,pe).call(g)},d&&d.addEventListener("input",m),v&&v.addEventListener("change",m),y&&y.addEventListener("change",m),(b=document.getElementById("syncBtn"))&&b.addEventListener("click",ee(z().mark((function e(){var t,n,r;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.onLine){e.next=3;break}return alert("Anda sedang offline. Sinkronisasi memerlukan koneksi internet."),e.abrupt("return");case 3:return b.disabled=!0,b.textContent="Menyinkronisasi...",e.prev=5,e.next=8,o.e(84).then(o.bind(o,84));case 8:return t=e.sent,n=t.syncOfflineStories,e.next=12,n();case 12:if(!((r=e.sent).success&&r.synced>0)){e.next=19;break}return alert("".concat(r.synced," story berhasil disinkronisasi!")),e.next=17,re(oe,g,pe).call(g);case 17:e.next=20;break;case 19:r.success&&0===r.synced?alert("Tidak ada story yang perlu disinkronisasi."):alert("Sinkronisasi gagal: ".concat(r.error||"Unknown error"));case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),console.error("Sync error:",e.t0),alert("Error: ".concat(e.t0.message));case 26:return e.prev=26,b.disabled=!1,b.textContent="Sinkronisasi",e.finish(26);case 30:case"end":return e.stop()}}),e,null,[[5,22,26,30]])}))));case 32:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}],t&&te(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function ie(){return ce.apply(this,arguments)}function ce(){return(ce=ee(z().mark((function e(){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e({lat:t.coords.latitude,lon:t.coords.longitude})}),(function(e){t(new Error("Tidak dapat mengambil lokasi GPS"))}),{timeout:1e4,maximumAge:6e4}):t(new Error("Geolocation tidak didukung oleh browser"))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return se.apply(this,arguments)}function se(){return se=ee(z().mark((function e(t){var n,r,o,a,i,c,u,s,l;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.description,r=t.photo,o=t.lat,a=t.lon,i=localStorage.getItem("authToken"),c=h.A.BASE_URL.replace(/\/+$/,""),(u=new FormData).append("description",n),u.append("photo",r),null!=o&&null!=a&&(u.append("lat",o),u.append("lon",a)),e.next=9,fetch("".concat(c,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(i)},body:u});case 9:return s=e.sent,e.next=12,s.json().catch((function(){return{}}));case 12:if(l=e.sent,s.ok&&!l.error){e.next=15;break}throw new Error(l.message||"HTTP ".concat(s.status));case 15:return e.abrupt("return",l);case 16:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function le(e){return fe.apply(this,arguments)}function fe(){return(fe=ee(z().mark((function e(t){var n,r,o,a,i;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,q.openDB)();case 2:return n=e.sent,r=n.transaction("offlineStories","readwrite"),o=r.objectStore("offlineStories"),e.next=7,re(oe,this,ve).call(this,t.photo);case 7:return a=e.sent,i={id:Date.now().toString(),description:t.description,photo:a,photoName:t.photo.name,photoType:t.photo.type,lat:t.lat,lon:t.lon,createdAt:(new Date).toISOString(),synced:!1},e.next=11,o.add(i);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function pe(){return de.apply(this,arguments)}function de(){return(de=ee(z().mark((function e(){var t,n,r,a,i,c,u,s,l,f,p,d,v,y,m,h=this;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("offlineList")){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,Promise.resolve().then(o.bind(o,652));case 6:return r=e.sent,a=r.getUnsyncedStories,e.next=10,a();case 10:if(i=e.sent,c=document.getElementById("searchOffline"),(u=(null==c||null===(n=c.value)||void 0===n?void 0:n.toLowerCase())||"")&&(i=i.filter((function(e){var t;return null===(t=e.description)||void 0===t?void 0:t.toLowerCase().includes(u)}))),s=document.getElementById("filterOffline"),"with-location"===(l=(null==s?void 0:s.value)||"all")?i=i.filter((function(e){return e.lat&&e.lon})):"no-location"===l&&(i=i.filter((function(e){return!e.lat||!e.lon}))),f=document.getElementById("sortOffline"),p=(null==f?void 0:f.value)||"newest",i.sort((function(e,t){switch(p){case"newest":return new Date(t.createdAt)-new Date(e.createdAt);case"oldest":return new Date(e.createdAt)-new Date(t.createdAt);case"description-asc":return(e.description||"").localeCompare(t.description||"");case"description-desc":return(t.description||"").localeCompare(e.description||"");default:return 0}})),!(d=document.getElementById("offlineStats"))){e.next=30;break}return e.next=24,Promise.resolve().then(o.bind(o,652));case 24:return v=e.sent,y=v.getUnsyncedStories,e.next=28,y();case 28:m=e.sent,d.textContent="Menampilkan ".concat(i.length," dari ").concat(m.length," story offline");case 30:if(0!==i.length){e.next=33;break}return t.innerHTML="<p>Tidak ada story offline yang sesuai dengan filter.</p>",e.abrupt("return");case 33:t.innerHTML=i.map((function(e){return'\n        <article class="offline-story-item" role="listitem" style="border:1px solid #ddd;padding:12px;margin:8px 0;border-radius:8px;background:#fff">\n          <p><strong>'.concat(re(oe,h,ye).call(h,e.description),"</strong></p>\n          <small>Dibuat: ").concat(new Date(e.createdAt).toLocaleString(),"</small>\n          ").concat(e.lat&&e.lon?'<small style="display:block;margin-top:4px">Lokasi: '.concat(e.lat.toFixed(6),", ").concat(e.lon.toFixed(6),"</small>"):"",'\n          <button \n            data-id="').concat(e.id,'" \n            class="delete-offline-btn" \n            style="margin-top:8px;padding:6px 12px;background:#dc3545;color:#fff;border:none;border-radius:4px;cursor:pointer"\n            aria-label="Hapus story offline">\n            Hapus\n          </button>\n        </article>\n      ')})).join(""),t.querySelectorAll(".delete-offline-btn").forEach((function(e){e.addEventListener("click",ee(z().mark((function t(){var n,r,a;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getAttribute("data-id"),!confirm("Hapus story offline ini?")){t.next=17;break}return t.prev=2,t.next=5,Promise.resolve().then(o.bind(o,652));case 5:return r=t.sent,a=r.deleteStory,t.next=9,a(n);case 9:return t.next=11,re(oe,h,pe).call(h);case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),console.error("Error deleting offline story:",t.t0),alert("Gagal menghapus story");case 17:case"end":return t.stop()}}),t,null,[[2,13]])}))))})),e.next=41;break;case 37:e.prev=37,e.t0=e.catch(3),console.error("Error loading offline stories:",e.t0),t.innerHTML="<p>Error memuat story offline.</p>";case 41:case"end":return e.stop()}}),e,null,[[3,37]])})))).apply(this,arguments)}function ve(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=n,r.readAsDataURL(e)}))}function ye(e){return String(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function me(e){return function(e){if(Array.isArray(e))return he(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return he(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function be(e){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},be(e)}function ge(){var e=Te(),t=e.m(ge),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,xe(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ge=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Ee(e,t)},AsyncIterator:Pe,async:function(e,t,n,o,i){return(r(t)?Se:we)(a(e),t,n,o,i)},keys:ke,values:xe}})()}function xe(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(be(e)+" is not iterable")}function ke(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function we(e,t,n,r,o){var a=Se(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function Se(e,t,n,r,o){return new Pe(Te().w(e,t,n,r),o||Promise)}function Pe(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof Ee?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(Oe(Pe.prototype),Oe(Pe.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Oe(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function Te(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Oe(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Oe(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Oe(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Oe(f,"constructor",s),Oe(s,"constructor",u),u.displayName="GeneratorFunction",Oe(s,o,"GeneratorFunction"),Oe(f),Oe(f,o,"Generator"),Oe(f,r,(function(){return this})),Oe(f,"toString",(function(){return"[object Generator]"})),(Te=function(){return{w:a,m:p}})()}function Oe(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Oe=function(e,t,n,r){function a(t,n){Oe(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Oe(e,t,n,r)}function Ee(e,t){this.v=e,this.k=t}function Ae(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function je(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Ae(a,r,o,i,c,"next",e)}function c(e){Ae(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Le(r.key),r)}}function Le(e){var t=function(e){if("object"!=be(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==be(t)?t:t+""}var _e=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"render",value:(r=je(ge().mark((function e(){return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'\n      <section class="container">\n        <h1>Story Tersimpan</h1>\n        <p style="color:#666;margin-bottom:16px">\n          Berikut adalah story yang telah Anda simpan sebagai favorit.\n        </p>\n        \n        <div id="favoriteNotice" class="notice" aria-live="polite"></div>\n        \n        \x3c!-- Filter and Sort Controls --\x3e\n        <div style="margin-bottom:16px;padding:12px;background:#f5f5f5;border-radius:8px">\n          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px">\n            <div>\n              <label for="searchFavorite" style="display:block;margin-bottom:4px;font-size:14px;font-weight:bold">Cari:</label>\n              <input \n                type="text" \n                id="searchFavorite" \n                placeholder="Cari deskripsi..." \n                style="width:100%;padding:6px;border:1px solid #ddd;border-radius:4px"\n                aria-label="Cari story favorit">\n            </div>\n            <div>\n              <label for="sortFavorite" style="display:block;margin-bottom:4px;font-size:14px;font-weight:bold">Urutkan:</label>\n              <select \n                id="sortFavorite" \n                style="width:100%;padding:6px;border:1px solid #ddd;border-radius:4px"\n                aria-label="Urutkan story favorit">\n                <option value="newest">Terbaru Disimpan</option>\n                <option value="oldest">Terlama Disimpan</option>\n                <option value="description-asc">Deskripsi A-Z</option>\n                <option value="description-desc">Deskripsi Z-A</option>\n              </select>\n            </div>\n          </div>\n          <div id="favoriteStats" style="font-size:12px;color:#666;margin-top:8px"></div>\n        </div>\n        \n        <div id="favoriteList" class="story-list" role="list" aria-label="Daftar story favorit"></div>\n        \n        <div id="emptyState" style="display:none;text-align:center;padding:40px;color:#999">\n          <p style="font-size:48px;margin:0"></p>\n          <p style="margin-top:16px;font-size:18px;font-weight:bold">Belum ada story yang disimpan</p>\n          <p style="margin-top:8px">Kunjungi <a href="#/home">Beranda</a> untuk melihat dan menyimpan story favorit Anda.</p>\n        </div>\n      </section>\n    ');case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=je(ge().mark((function e(){var t,n,r,o,a,i,c;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("favoriteList"),n=document.getElementById("favoriteNotice"),r=document.getElementById("emptyState"),o=document.getElementById("searchFavorite"),a=document.getElementById("sortFavorite"),i=document.getElementById("favoriteStats"),t){e.next=8;break}return e.abrupt("return");case 8:return c=function(){var e=je(ge().mark((function e(){var u,s,l,f,p;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,q.getAllFavorites)();case 3:if(u=e.sent,Array.isArray(u)||(console.error("[favorite] getAllFavorites returned non-array:",be(u),u),u=[]),0!==u.length){e.next=10;break}return t.innerHTML="",r.style.display="block",i&&(i.textContent="0 story tersimpan"),e.abrupt("return");case 10:if(r.style.display="none",s=Array.isArray(u)?me(u):[],o&&o.value.trim()&&(l=o.value.trim().toLowerCase(),s=s.filter((function(e){return(e.description||"").toLowerCase().includes(l)||(e.name||"").toLowerCase().includes(l)}))),f=(null==a?void 0:a.value)||"newest",s.sort((function(e,t){switch(f){case"newest":return new Date(t.savedAt)-new Date(e.savedAt);case"oldest":return new Date(e.savedAt)-new Date(t.savedAt);case"description-asc":return(e.description||"").localeCompare(t.description||"");case"description-desc":return(t.description||"").localeCompare(e.description||"");default:return 0}})),i&&(i.textContent="Menampilkan ".concat(s.length," dari ").concat(u.length," story tersimpan")),0!==s.length){e.next=19;break}return t.innerHTML='<p style="text-align:center;padding:20px;color:#999">Tidak ada story yang cocok dengan pencarian Anda.</p>',e.abrupt("return");case 19:t.innerHTML=s.map((function(e){var t=new Date(e.savedAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"});return'\n            <article class="story-card" style="margin-bottom:16px;padding:16px;background:#fff;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1)">\n              '.concat(e.photoUrl?'\n                <img \n                  src="'.concat(e.photoUrl,'" \n                  alt="').concat(e.name?"".concat(e.name," - ").concat(e.description||"Gambar story"):e.description||"Gambar story favorit",'" \n                  style="width:100%;height:200px;object-fit:cover;border-radius:8px;margin-bottom:12px"\n                  loading="lazy"\n                  onerror="this.style.display=\'none\'">\n              '):"",'\n              \n              <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px">\n                <div style="flex:1">\n                  ').concat(e.name?'<h3 style="margin:0 0 8px 0;font-size:18px">'.concat(e.name,"</h3>"):"",'\n                  <p style="margin:0;color:#666;line-height:1.6">').concat(e.description||"Tidak ada deskripsi",'</p>\n                </div>\n                <button \n                  class="unbookmark-btn" \n                  data-story-id="').concat(e.id,'"\n                  aria-label="Hapus dari favorit"\n                  style="padding:8px 12px;background:#f44336;color:#fff;border:none;border-radius:6px;cursor:pointer;margin-left:12px;white-space:nowrap">\n                   Hapus\n                </button>\n              </div>\n              \n              ').concat(e.lat&&e.lon?'\n                <p style="margin:8px 0;font-size:12px;color:#999">\n                   Lokasi: '.concat(e.lat.toFixed(6),", ").concat(e.lon.toFixed(6),"\n                </p>\n              "):"",'\n              \n              <p style="margin:8px 0 0 0;font-size:12px;color:#999">\n                Disimpan pada: ').concat(t,"\n              </p>\n            </article>\n          ")})).join(""),t.querySelectorAll(".unbookmark-btn").forEach((function(e){e.addEventListener("click",function(){var t=je(ge().mark((function t(r){var o;return ge().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r.target.closest(".unbookmark-btn").dataset.storyId){t.next=3;break}return t.abrupt("return");case 3:if(!confirm("Apakah Anda yakin ingin menghapus story ini dari favorit?")){t.next=20;break}return t.prev=4,e.disabled=!0,e.textContent="Menghapus...",t.next=9,(0,q.removeFavorite)(o);case 9:return n&&(n.innerHTML='<p style="color:green">Story berhasil dihapus dari favorit!</p>',setTimeout((function(){n.innerHTML=""}),2e3)),t.next=12,c();case 12:t.next=20;break;case 14:t.prev=14,t.t0=t.catch(4),console.error("Error removing favorite:",t.t0),n&&(n.innerHTML='<p class="error">Gagal menghapus dari favorit: '.concat(t.t0.message,"</p>")),e.disabled=!1,e.textContent=" Hapus";case 20:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}())})),e.next=31;break;case 24:e.prev=24,e.t0=e.catch(0),console.error("Error loading favorites:",e.t0),n&&(p="Gagal memuat story favorit.",e.t0.message&&(p+=" ".concat(e.t0.message)),e.t0.message&&e.t0.message.includes("not iterable")&&(p+="<br/><br/><small>Silakan refresh halaman untuk memperbaiki masalah ini.</small>"),n.innerHTML='<p class="error">'.concat(p,"</p>")),t.innerHTML="",r&&(r.style.display="block"),i&&(i.textContent="Error memuat data");case 31:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),o&&o.addEventListener("input",c),a&&a.addEventListener("change",c),e.next=13,c();case 13:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}],t&&Ie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}();function Ne(e){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ne(e)}function Fe(){var e=He(),t=e.m(Fe),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,Be(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Fe=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new qe(e,t)},AsyncIterator:De,async:function(e,t,n,o,i){return(r(t)?Me:Ge)(a(e),t,n,o,i)},keys:Ce,values:Be}})()}function Be(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ne(e)+" is not iterable")}function Ce(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Ge(e,t,n,r,o){var a=Me(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function Me(e,t,n,r,o){return new De(He().w(e,t,n,r),o||Promise)}function De(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof qe?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(Ue(De.prototype),Ue(De.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ue(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function He(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return Ue(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(Ue(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,Ue(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,Ue(f,"constructor",s),Ue(s,"constructor",u),u.displayName="GeneratorFunction",Ue(s,o,"GeneratorFunction"),Ue(f),Ue(f,o,"Generator"),Ue(f,r,(function(){return this})),Ue(f,"toString",(function(){return"[object Generator]"})),(He=function(){return{w:a,m:p}})()}function Ue(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ue=function(e,t,n,r){function a(t,n){Ue(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Ue(e,t,n,r)}function qe(e,t){this.v=e,this.k=t}function Re(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function ze(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Re(a,r,o,i,c,"next",e)}function c(e){Re(a,r,o,i,c,"throw",e)}i(void 0)}))}}var Ve=function(){var e=ze(Fe().mark((function e(){return Fe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'\n    <section class="container">\n      <h1>Login</h1>\n\n      <form id="loginForm" class="form-auth" novalidate>\n        <div class="form-group">\n          <label for="email">Email</label>\n          <input id="email" type="email" name="email" autocomplete="email" required placeholder="Masukkan email" />\n        </div>\n\n        <div class="form-group" style="margin-top:8px">\n          <label for="password">Password</label>\n          <input id="password" type="password" name="password" autocomplete="current-password" required placeholder="Masukkan password" />\n          <label for="togglePw" style="display:inline-flex;gap:6px;align-items:center;margin-top:6px">\n            <input id="togglePw" type="checkbox" />\n            <span>Tampilkan password</span>\n          </label>\n        </div>\n\n        <button id="loginBtn" type="submit" style="margin-top:12px">Login</button>\n      </form>\n\n      <div id="loginMessage" class="auth-message" aria-live="polite" style="margin-top:10px"></div>\n    </section>\n  ');case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ke=!1,Ye=null;Ve.afterRender=function(){var e=document.getElementById("loginForm"),t=document.getElementById("loginBtn"),n=document.getElementById("loginMessage");if(document.getElementById("email"),document.getElementById("password"),document.getElementById("togglePw"),e&&t&&n){var r=location.hash;if(Ye===r&&Ke)console.log("[login] Setup already done for this route, skipping");else{Ye=r,Ke=!0,console.log("[login] Setting up form for route:",r);var o=e.cloneNode(!0);e.parentNode.replaceChild(o,e);var a=document.getElementById("loginForm"),i=document.getElementById("loginBtn"),c=document.getElementById("loginMessage"),u=document.getElementById("email"),s=document.getElementById("password"),l=document.getElementById("togglePw");if(a&&i&&c){if(localStorage.getItem("authToken"))return c.textContent="Anda sudah login. Mengalihkan ke beranda",setTimeout((function(){"#/home"!==location.hash&&(location.hash="#/home")}),250),void(Ke=!1);var f=sessionStorage.getItem("registeredEmail");f&&u&&!u.value&&(u.value=f,console.log("[login] Auto-filled email from registration")),l&&s&&l.addEventListener("change",(function(){s.type=l.checked?"text":"password"})),a.addEventListener("submit",function(){var e=ze(Fe().mark((function e(t){var n,r,o,l,f,p,d,v,y,m,b,g;return Fe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=((null==u?void 0:u.value)||"").trim(),r=((null==s?void 0:s.value)||"").trim(),n&&r){e.next=6;break}return c.textContent="Email dan password wajib diisi.",e.abrupt("return");case 6:return i.disabled=!0,c.textContent="Sedang login",console.log("[login] Attempting login with:",{email:n,passwordLength:r.length}),e.prev=9,e.next=12,fetch("".concat(h.A.BASE_URL,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 12:return d=e.sent,e.next=15,d.json().catch((function(){return{}}));case 15:if(v=e.sent,console.log("[login] Response status:",d.status),console.log("[login] Response data:",JSON.stringify(v,null,2)),401!==d.status){e.next=29;break}return y=v.message||"Unauthorized",console.error("[login] 401 Error:",y),console.error("[login] Email used:",n),console.error("[login] Password length:",r.length),console.error("[login] Full response:",v),m=sessionStorage.getItem("registeredEmail"),c.innerHTML=m===n?'<p class="error"><strong>User not found</strong><br/><br/>Email: <strong>'.concat(n,"</strong><br/><br/>Kemungkinan:<br/>1. Register mungkin belum selesai diproses server<br/>2. Coba tunggu beberapa detik lalu login lagi<br/>3. Atau register ulang dengan email berbeda<br/><br/><small>Cek console untuk detail response dari API</small></p>"):'<p class="error"><strong>User not found</strong><br/><br/>Email <strong>'.concat(n,"</strong> tidak terdaftar.<br/><br/>Silakan register terlebih dahulu.</p>"),i.disabled=!1,Ke=!1,e.abrupt("return");case 29:if(d.ok&&(!v||!0!==v.error)){e.next=36;break}return b=(null==v?void 0:v.message)||(null==v?void 0:v.error)||"HTTP ".concat(d.status),console.error("[login] Login failed:",b),c.innerHTML='<p class="error">Error: '.concat(b,"<br/>Status: ").concat(d.status,"</p>"),i.disabled=!1,Ke=!1,e.abrupt("return");case 36:if(g=null==v||null===(o=v.loginResult)||void 0===o?void 0:o.token){e.next=43;break}return c.innerHTML='<p class="error">Token tidak ditemukan pada respons. Format response mungkin berubah.</p>',console.error("Login response:",v),i.disabled=!1,Ke=!1,e.abrupt("return");case 43:localStorage.setItem("authToken",g),null!=v&&null!==(l=v.loginResult)&&void 0!==l&&l.name&&localStorage.setItem("authName",v.loginResult.name),sessionStorage.removeItem("registeredEmail"),c.innerHTML='<p style="color:green">Login berhasil! Selamat datang, '.concat(null!==(f=null==v||null===(p=v.loginResult)||void 0===p?void 0:p.name)&&void 0!==f?f:"User",".</p>"),a.reset(),"function"==typeof window.updateNavigation&&window.updateNavigation(),setTimeout((function(){"#/home"!==location.hash&&(location.hash="#/home")}),150),e.next=57;break;case 52:e.prev=52,e.t0=e.catch(9),console.error("Login error:",e.t0),"TypeError"===e.t0.name||e.t0.message.includes("fetch")?c.innerHTML='<p class="error">Gagal terhubung ke server. Periksa koneksi internet kamu.</p>':c.innerHTML='<p class="error">Error: '.concat(e.t0.message,"</p>"),Ke=!1;case 57:return e.prev=57,i.disabled=!1,e.finish(57);case 60:case"end":return e.stop()}}),e,null,[[9,52,57,60]])})));return function(t){return e.apply(this,arguments)}}())}else Ke=!1}}else console.warn("[login] Form elements not found")};const We=Ve;function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Ze(){var e=nt(),t=e.m(Ze),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,$e(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ze=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new ot(e,t)},AsyncIterator:tt,async:function(e,t,n,o,i){return(r(t)?et:Qe)(a(e),t,n,o,i)},keys:Xe,values:$e}})()}function $e(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Je(e)+" is not iterable")}function Xe(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Qe(e,t,n,r,o){var a=et(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function et(e,t,n,r,o){return new tt(nt().w(e,t,n,r),o||Promise)}function tt(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof ot?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(rt(tt.prototype),rt(tt.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),rt(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function nt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return rt(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(rt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,rt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,rt(f,"constructor",s),rt(s,"constructor",u),u.displayName="GeneratorFunction",rt(s,o,"GeneratorFunction"),rt(f),rt(f,o,"Generator"),rt(f,r,(function(){return this})),rt(f,"toString",(function(){return"[object Generator]"})),(nt=function(){return{w:a,m:p}})()}function rt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}rt=function(e,t,n,r){function a(t,n){rt(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},rt(e,t,n,r)}function ot(e,t){this.v=e,this.k=t}function at(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function it(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){at(a,r,o,i,c,"next",e)}function c(e){at(a,r,o,i,c,"throw",e)}i(void 0)}))}}const ct=function(){var e=it(Ze().mark((function e(){var t,n,r,o;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=location.hash,n=null,r=!1,o=function(){if(r&&n===t)console.log("[register] Setup already done for this route, skipping");else if(n!==t&&(r=!1,n=t),!r){r=!0,console.log("[register] Setting up form for route:",t);var e=document.getElementById("registerForm"),o=document.getElementById("regBtn"),a=document.getElementById("regMsg");if(e&&o&&a){var i=e.cloneNode(!0);e.parentNode.replaceChild(i,e);var c=document.getElementById("registerForm"),u=document.getElementById("regBtn"),s=document.getElementById("regMsg");c&&u&&s?c.addEventListener("submit",function(){var e=it(Ze().mark((function e(t){var n,r,o,a,i,l,f,p,d,v,y;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=c.name.value.trim(),r=c.email.value.trim(),o=c.password.value.trim(),n&&r&&o){e.next=7;break}return s.innerHTML='<p class="error">Semua field wajib diisi.</p>',e.abrupt("return");case 7:if(!(o.length<6)){e.next=10;break}return s.innerHTML='<p class="error">Password minimal 6 karakter.</p>',e.abrupt("return");case 10:return u.disabled=!0,s.innerHTML='<p style="color:#666">Mendaftarkan akun...</p>',console.log("[register] Registering with:",{name:n,email:r,passwordLength:o.length}),e.prev=13,e.next=16,fetch("".concat(h.A.BASE_URL,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:r,password:o})});case 16:return a=e.sent,e.next=19,a.json().catch((function(){return{}}));case 19:if(i=e.sent,console.log("[register] Response status:",a.status),console.log("[register] Response headers:",a.headers),console.log("[register] Response data:",JSON.stringify(i,null,2)),a.ok){e.next=30;break}return l=i.message||i.error||"HTTP ".concat(a.status),console.error("[register] Registration failed:",l),s.innerHTML='<p class="error">Gagal register: '.concat(l,"</p>"),400===a.status&&l.includes("email")&&(s.innerHTML='<p class="error">Email sudah terdaftar. Gunakan email lain atau silakan login.</p>'),u.disabled=!1,e.abrupt("return");case 30:if(!(!0===i.error||i.message&&i.message.toLowerCase().includes("error"))){e.next=36;break}return f=i.message||"Unknown error",console.error("[register] Registration failed (error in data):",f),s.innerHTML='<p class="error">Gagal register: '.concat(f,"</p>"),u.disabled=!1,e.abrupt("return");case 36:if(p=201===a.status||200===a.status&&(!i||!i.error)||a.status<400&&(!i||!0!==i.error),console.log("[register] Registration check:",{status:a.status,hasError:null==i?void 0:i.error,isSuccess:p,data:i}),!(a.status>=200&&a.status<300)){e.next=55;break}if(!i||!0!==i.error){e.next=45;break}return d=i.message||"Unknown error",console.error("[register] Registration failed (error in response):",d),s.innerHTML='<p class="error">Gagal register: '.concat(d,"</p>"),u.disabled=!1,e.abrupt("return");case 45:return console.log("[register]  Registration SUCCESS!",i),v='<div style="color:#155724;font-weight:bold;padding:20px;background:#d4edda;border-radius:8px;border:2px solid #28a745;margin:12px 0;box-shadow:0 2px 8px rgba(0,0,0,0.1);"><div style="font-size:20px;margin-bottom:10px;"> Registrasi Berhasil!</div><div style="font-size:14px;color:#155724;margin-top:8px;line-height:1.6;">Email: <strong style="color:#0d47a1;font-size:16px;">'+r+"</strong><br/>Password: <strong>"+o.length+' karakter</strong><br/><br/><span style="color:#666;font-size:13px;">Mengalihkan ke halaman login dalam 2 detik...</span></div></div>',s.innerHTML=v,setTimeout((function(){s&&s.scrollIntoView({behavior:"smooth",block:"center"})}),100),sessionStorage.setItem("registeredEmail",r),console.log("[register] Scheduling redirect to login in 2 seconds..."),y=!1,setTimeout((function(){if(!y){y=!0;var e=location.hash;console.log("[register] Current hash:",e),console.log("[register] Redirecting to #/login..."),window.location.hash="#/login",setTimeout((function(){"#/login"!==location.hash&&(console.log("[register] Hash change not detected, forcing..."),window.dispatchEvent(new HashChangeEvent("hashchange")))}),100)}}),2e3),u.disabled=!1,e.abrupt("return");case 55:return console.error("[register] Registration failed. Status:",a.status,"Data:",i),s.innerHTML='<p class="error">Registrasi gagal.<br/>Status: '+a.status+"<br/>Response: "+JSON.stringify(i)+"<br/><br/>Cek console untuk detail lebih lanjut.</p>",u.disabled=!1,e.abrupt("return");case 61:e.prev=61,e.t0=e.catch(13),console.error("Register error:",e.t0),s.innerHTML='<p class="error">Gagal register: '.concat(e.t0.message,"</p>");case 65:return e.prev=65,u.disabled=!1,e.finish(65);case 68:case"end":return e.stop()}}),e,null,[[13,61,65,68]])})));return function(t){return e.apply(this,arguments)}}()):r=!1}else r=!1}},requestAnimationFrame((function(){setTimeout((function(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",o):o()}),150)})),e.abrupt("return",'\n    <section class="container">\n      <h1>Register</h1>\n\n      <form id="registerForm" class="form-auth" novalidate>\n        <div class="form-group">\n          <label for="name">Nama</label>\n          <input id="name" name="name" required />\n        </div>\n\n        <div class="form-group" style="margin-top:8px">\n          <label for="email">Email</label>\n          <input id="email" type="email" name="email" required />\n        </div>\n\n        <div class="form-group" style="margin-top:8px">\n          <label for="password">Password</label>\n          <input id="password" type="password" name="password" minlength="6" required />\n        </div>\n\n        \x3c!-- PENTING: tombol submit DI DALAM form dan type="submit" --\x3e\n        <button id="regBtn" type="submit" style="margin-top:12px">Register</button>\n      </form>\n\n      <div id="regMsg" class="auth-message" aria-live="polite" style="margin-top:10px"></div>\n    </section>\n  ');case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var ut=["timestamp"],st=["timestamp"];function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ft(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function pt(){var e=bt(),t=e.m(pt),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,dt(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(pt=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new xt(e,t)},AsyncIterator:ht,async:function(e,t,n,o,i){return(r(t)?mt:yt)(a(e),t,n,o,i)},keys:vt,values:dt}})()}function dt(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(lt(e)+" is not iterable")}function vt(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function yt(e,t,n,r,o){var a=mt(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function mt(e,t,n,r,o){return new ht(bt().w(e,t,n,r),o||Promise)}function ht(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof xt?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(gt(ht.prototype),gt(ht.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),gt(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function bt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return gt(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(gt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,gt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,gt(f,"constructor",s),gt(s,"constructor",u),u.displayName="GeneratorFunction",gt(s,o,"GeneratorFunction"),gt(f),gt(f,o,"Generator"),gt(f,r,(function(){return this})),gt(f,"toString",(function(){return"[object Generator]"})),(bt=function(){return{w:a,m:p}})()}function gt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}gt=function(e,t,n,r){function a(t,n){gt(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},gt(e,t,n,r)}function xt(e,t){this.v=e,this.k=t}function kt(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function wt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){kt(a,r,o,i,c,"next",e)}function c(e){kt(a,r,o,i,c,"throw",e)}i(void 0)}))}}function St(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pt(r.key),r)}}function Pt(e){var t=function(e){if("object"!=lt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==lt(t)?t:t+""}function Tt(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Ot=new WeakSet;function Et(){return At.apply(this,arguments)}function At(){return(At=wt(pt().mark((function e(){var t,n,r,a,i,c,u,s,l,f,p,d,v,y,m,b=this;return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("pushToggleBtn"),n=document.getElementById("pushToggleText"),t&&n){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,o.e(15).then(o.bind(o,15));case 7:if((r=e.sent).registerServiceWorker,a=r.getPushSubscription,i=r.subscribeToPush,c=r.unsubscribeFromPush,u=r.sendSubscriptionToServer,s=r.removeSubscriptionFromServer,"serviceWorker"in navigator&&"PushManager"in window){e.next=19;break}return t.disabled=!0,n.textContent=" Push Unavailable",t.title="Browser tidak mendukung push notification",e.abrupt("return");case 19:return f=!1,e.prev=20,e.next=23,navigator.serviceWorker.ready;case 23:return l=e.sent,e.next=26,a(l);case 26:if(p=e.sent,Tt(Ot,this,jt).call(this,p,n),e.prev=28,console.log("[home] Checking VAPID key. CONFIG:",h.A),console.log("[home] CONFIG.VAPID_PUBLIC_KEY:",h.A.VAPID_PUBLIC_KEY),console.log("[home] CONFIG.VAPID_PUBLIC_KEY type:",lt(h.A.VAPID_PUBLIC_KEY)),console.log("[home] CONFIG.VAPID_PUBLIC_KEY truthy?",!!h.A.VAPID_PUBLIC_KEY),!h.A.VAPID_PUBLIC_KEY||""===h.A.VAPID_PUBLIC_KEY.trim()){e.next=38;break}f=!0,console.log("[home]  VAPID key found in CONFIG:",h.A.VAPID_PUBLIC_KEY.substring(0,20)+"..."),e.next=48;break;case 38:return console.warn("[home]  CONFIG.VAPID_PUBLIC_KEY is empty, trying utility function..."),e.next=41,o.e(15).then(o.bind(o,15));case 41:return d=e.sent,v=d.getVapidPublicKey,e.next=45,v();case 45:y=e.sent,f=!!y,console.log("[home] VAPID key from utility:",y?y.substring(0,20)+"...":"null");case 48:e.next=54;break;case 50:e.prev=50,e.t0=e.catch(28),console.error("[home]  Error checking VAPID key:",e.t0),f=!1;case 54:e.next=63;break;case 56:return e.prev=56,e.t1=e.catch(20),console.warn("[home] Push setup error (non-critical):",e.t1),t.disabled=!0,n.textContent=" Push Unavailable",t.title="Push notification tidak tersedia",e.abrupt("return");case 63:if(l){e.next=68;break}return t.disabled=!0,n.textContent=" Push Unavailable",t.title="Service Worker tidak tersedia",e.abrupt("return");case 68:m=l,f?t.disabled=!1:(t.disabled=!0,n.textContent=" Push Unavailable",t.title="Push notification tidak tersedia. VAPID key tidak ditemukan. Silakan set CONFIG.VAPID_PUBLIC_KEY atau pastikan endpoint /vapid-public-key tersedia."),t.addEventListener("click",wt(pt().mark((function e(){var r,l,f,p;return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.disabled=!0,e.prev=1,localStorage.getItem("authToken")){e.next=7;break}return alert("Anda harus login terlebih dahulu untuk mengaktifkan push notification.\n\nSilakan login terlebih dahulu."),t.disabled=!1,e.abrupt("return");case 7:return e.next=9,a(m);case 9:if(!e.sent){e.next=18;break}return e.next=13,c(m);case 13:return e.next=15,s().catch((function(){}));case 15:Tt(Ot,b,jt).call(b,null,n),e.next=54;break;case 18:return e.next=20,Notification.requestPermission();case 20:if("granted"===e.sent){e.next=24;break}return t.disabled=!1,e.abrupt("return");case 24:if(r=h.A.VAPID_PUBLIC_KEY){e.next=33;break}return e.next=28,o.e(15).then(o.bind(o,15));case 28:return l=e.sent,f=l.getVapidPublicKey,e.next=32,f();case 32:r=e.sent;case 33:if(console.log("[home] VAPID key check on click:",r?r.substring(0,20)+"...":"null"),r){e.next=40;break}return alert("VAPID key tidak tersedia. Push notification tidak dapat diaktifkan.\n\nSilakan:\n1. Set CONFIG.VAPID_PUBLIC_KEY di config.js, atau\n2. Pastikan endpoint /vapid-public-key tersedia di API."),t.disabled=!0,n.textContent=" Push Unavailable",t.title="VAPID key tidak tersedia",e.abrupt("return");case 40:return e.next=42,i(m);case 42:if(!(p=e.sent)){e.next=50;break}return e.next=46,u(p).catch((function(){console.warn("[home] Server subscription failed, but local subscription is active")}));case 46:Tt(Ot,b,jt).call(b,p,n),t.disabled=!1,e.next=54;break;case 50:alert("Gagal subscribe push notification. Pastikan VAPID key valid."),t.disabled=!0,n.textContent=" Push Unavailable",t.title="Gagal subscribe push notification";case 54:e.next=61;break;case 56:e.prev=56,e.t0=e.catch(1),console.error("[home] Push toggle error:",e.t0),!e.t0.message||e.t0.message.includes("fetch")||e.t0.message.includes("network")?console.warn("[home] Network error during push toggle, but operation may have succeeded locally"):alert("Error: ".concat(e.t0.message||"Gagal mengubah status push notification")),t.disabled=!1;case 61:return e.prev=61,t.disabled||(t.disabled=!1),e.finish(61);case 64:case"end":return e.stop()}}),e,null,[[1,56,61,64]])})))),e.next=77;break;case 73:e.prev=73,e.t2=e.catch(4),console.error("[home] Push setup error:",e.t2),t&&n&&(t.disabled=!0,n.textContent=" Push Unavailable",t.title="Push notification tidak tersedia");case 77:case"end":return e.stop()}}),e,this,[[4,73],[20,56],[28,50]])})))).apply(this,arguments)}function jt(e,t){t&&(e?(t.textContent=" Push On",t.parentElement.style.background="#e8f5e9",t.parentElement.style.borderColor="#4caf50"):(t.textContent=" Push Off",t.parentElement.style.background="#fff",t.parentElement.style.borderColor="#ddd"))}function It(e,t){if(null==e||null==t)return"";var n=Number(e),r=Number(t);return Number.isFinite(n)&&Number.isFinite(r)?"  (".concat(n.toFixed(3),", ").concat(r.toFixed(3),")"):""}function Lt(e){try{return new Date(e).toLocaleString()}catch(e){return"-"}}function _t(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}const Nt={"/home":function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,Ot)},t=[{key:"render",value:(r=wt(pt().mark((function e(){return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",'\n      <section class="container">\n        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">\n          <h1 style="margin:0">Daftar Story</h1>\n          <button \n            id="pushToggleBtn" \n            class="push-toggle-btn" \n            aria-label="Toggle push notification"\n            style="padding:8px 16px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer">\n            <span id="pushToggleText"> Push Off</span>\n          </button>\n        </div>\n\n        <div id="homeNotice" class="notice" aria-live="polite"></div>\n\n        \x3c!-- Peta --\x3e\n        <div id="homeMap" style="height:360px;margin:12px 0;border-radius:12px" aria-label="Peta lokasi story"></div>\n\n        \x3c!-- List --\x3e\n        <h2>Daftar Cerita</h2>\n        <div id="storyList" class="story-list" role="list"></div>\n      </section>\n    ');case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=wt(pt().mark((function e(){var t,n,r,o,a,i,c,u,s,l,f,p,d,v,y,m,b,g,x,k,w,S,P,T,O,E,A=this;return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=document.getElementById("homeNotice"),o=document.getElementById("storyList"),a=document.getElementById("homeMap"),i=(null===h.A||void 0===h.A?void 0:h.A.AUTH_TOKEN)||localStorage.getItem("authToken")){e.next=9;break}return r.innerHTML='\n        <p>Untuk melihat data dari API, silakan <a href="#/login">login</a> terlebih dahulu.</p>\n      ',o.innerHTML="",a.innerHTML='<p role="alert" style="padding:8px">Peta akan tampil setelah login.</p>',e.abrupt("return");case 9:try{console.debug("[home] API keys =",U&&Object.keys(U||{}),"token?",!!i)}catch(e){}if(r.textContent="Loading...",r.setAttribute("aria-busy","true"),c=[],e.prev=14,navigator.onLine){e.next=24;break}return e.next=18,(0,q.getCachedStories)();case 18:u=e.sent,(c=u.map((function(e){return e.timestamp,ft(e,ut)}))).length>0?r.innerHTML='<p style="color:orange">Mode offline: Menampilkan data cache ('.concat(c.length," story)</p>"):r.innerHTML='<p class="error">Offline dan tidak ada data cache.</p>',e.next=44;break;case 24:return s=U&&"function"==typeof U.getStories,l=function(){var e=wt(pt().mark((function e(t){var n,r,o,a,c,u;return pt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=((null===h.A||void 0===h.A?void 0:h.A.BASE_URL)||"https://story-api.dicoding.dev/v1").replace(/\/+$/,""),(a=new URL("".concat(o,"/stories"))).searchParams.set("page",null!==(n=null==t?void 0:t.page)&&void 0!==n?n:1),a.searchParams.set("size",null!==(r=null==t?void 0:t.size)&&void 0!==r?r:9),null!=(null==t?void 0:t.location)&&a.searchParams.set("location",t.location),e.next=7,fetch(a.toString(),{headers:{Authorization:"Bearer ".concat(i)}});case 7:return c=e.sent,e.next=10,c.json().catch((function(){return{}}));case 10:if(u=e.sent,c.ok&&!u.error){e.next=13;break}throw new Error(u.message||"HTTP ".concat(c.status));case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=s?U.getStories:l,e.next=29,f({page:1,size:9,location:1});case 29:if(p=e.sent,d=p.listStory,v=void 0===d?[]:d,(c=Array.isArray(v)?v:[]).length){e.next=40;break}return e.next=36,f({page:1,size:9,location:0});case 36:y=e.sent,m=y.listStory,b=void 0===m?[]:m,c=Array.isArray(b)?b:[];case 40:if(!(c.length>0)){e.next=43;break}return e.next=43,(0,q.cacheStories)(c);case 43:r.textContent="";case 44:e.next=65;break;case 46:if(e.prev=46,e.t0=e.catch(14),console.error("[home] load stories error:",e.t0),navigator.onLine&&!e.t0.message.includes("fetch")){e.next=64;break}return e.prev=50,e.next=53,(0,q.getCachedStories)();case 53:g=e.sent,(c=g.map((function(e){return e.timestamp,ft(e,st)}))).length>0?r.innerHTML='<p style="color:orange">Koneksi bermasalah. Menampilkan data cache ('.concat(c.length," story)</p>"):r.innerHTML='<p class="error">Gagal memuat data: '.concat(Tt(Ot,this,_t).call(this,e.t0.message||"Unknown error"),"</p>"),e.next=62;break;case 59:e.prev=59,e.t1=e.catch(50),r.innerHTML='<p class="error">Gagal memuat data: '.concat(Tt(Ot,this,_t).call(this,e.t0.message||"Unknown error"),"</p>");case 62:e.next=65;break;case 64:r.innerHTML='<p class="error">Gagal memuat data: '.concat(Tt(Ot,this,_t).call(this,e.t0.message||"Unknown error"),"</p>");case 65:return e.prev=65,r.removeAttribute("aria-busy"),e.finish(65);case 68:if(x=new URLSearchParams(window.location.search),k=x.get("storyId"),c.length){e.next=74;break}o.innerHTML="<p>Tidak ada data untuk ditampilkan.</p>",e.next=82;break;case 74:return e.next=76,Promise.all(c.map((function(e){return(0,q.isFavorite)(e.id)})));case 76:w=e.sent,o.innerHTML=c.map((function(e,t){var n,r,o=w[t];return'\n        <article class="story-item" role="listitem" data-idx="'.concat(t,'" data-story-id="').concat(e.id||t,'" style="position:relative">\n          <img src="').concat(e.photoUrl,'"\n               alt="').concat(e.name?"".concat(Tt(Ot,A,_t).call(A,e.name)," - ").concat(e.description?Tt(Ot,A,_t).call(A,e.description):"Foto story"):e.description?Tt(Ot,A,_t).call(A,e.description):"Foto story",'"\n               loading="eager"\n               decoding="async"\n               style="cursor:pointer"\n               onerror="this.onerror=null;this.src=\'data:image/svg+xml;utf8,').concat(encodeURIComponent("<svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;640&quot; height=&quot;360&quot;><rect width=&quot;100%&quot; height=&quot;100%&quot; fill=&quot;#eee&quot;/><text x=&quot;50%&quot; y=&quot;50%&quot; dominant-baseline=&quot;middle&quot; text-anchor=&quot;middle&quot; fill=&quot;#999&quot; font-size=&quot;18&quot; font-family=&quot;system-ui&quot;>No Photo</text></svg>"),'\';" />\n          <button \n            class="bookmark-btn" \n            data-story-id="').concat(e.id||t,'"\n            data-is-favorite="').concat(o,'"\n            aria-label="').concat(o?"Hapus dari favorit":"Simpan ke favorit",'"\n            style="position:absolute;top:8px;right:8px;padding:8px 12px;background:').concat(o?"#f44336":"#4caf50",';color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:16px;z-index:10;box-shadow:0 2px 4px rgba(0,0,0,0.2)"\n            onclick="event.stopPropagation()">\n            ').concat(o?" Favorit":" Simpan",'\n          </button>\n          <div class="story-body" style="cursor:pointer">\n            <h3 class="story-title">').concat(Tt(Ot,A,_t).call(A,null!==(n=e.name)&&void 0!==n?n:"Tanpa Nama"),"</h3>\n            <p>").concat(Tt(Ot,A,_t).call(A,null!==(r=e.description)&&void 0!==r?r:"-"),'</p>\n            <small class="story-meta">\n              ').concat(Tt(Ot,A,Lt).call(A,e.createdAt)).concat(Tt(Ot,A,It).call(A,e.lat,e.lon),"\n            </small>\n          </div>\n        </article>\n      ")})).join(""),o.querySelectorAll(".bookmark-btn").forEach((function(e){e.addEventListener("click",function(){var t=wt(pt().mark((function t(n){var r,o,a;return pt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.stopPropagation(),r=e.dataset.storyId,o="true"===e.dataset.isFavorite,a=c.find((function(e){return(e.id||c.indexOf(e)).toString()===r.toString()}))){t.next=6;break}return t.abrupt("return");case 6:if(t.prev=6,e.disabled=!0,!o){t.next=17;break}return t.next=11,(0,q.removeFavorite)(a.id);case 11:e.dataset.isFavorite="false",e.style.background="#4caf50",e.innerHTML=" Simpan",e.setAttribute("aria-label","Simpan ke favorit"),t.next=23;break;case 17:return t.next=19,(0,q.addFavorite)({id:a.id,name:a.name,description:a.description,photoUrl:a.photoUrl,createdAt:a.createdAt,lat:a.lat,lon:a.lon});case 19:e.dataset.isFavorite="true",e.style.background="#f44336",e.innerHTML=" Favorit",e.setAttribute("aria-label","Hapus dari favorit");case 23:t.next=29;break;case 25:t.prev=25,t.t0=t.catch(6),console.error("Error toggling favorite:",t.t0),alert("Gagal ".concat(o?"menghapus":"menyimpan"," favorit: ").concat(t.t0.message));case 29:return t.prev=29,e.disabled=!1,t.finish(29);case 32:case"end":return t.stop()}}),t,null,[[6,25,29,32]])})));return function(e){return t.apply(this,arguments)}}())})),o.querySelectorAll(".story-item").forEach((function(e){var t=parseInt(e.dataset.idx),n=c[t];n&&n.lat&&n.lon&&e.addEventListener("click",(function(){var e=O._layers[Object.keys(O._layers).find((function(e){var t=O._layers[e];return t instanceof L.Marker&&t.getLatLng().lat===Number(n.lat)&&t.getLatLng().lng===Number(n.lon)}))];e&&(e.openPopup(),O.flyTo([Number(n.lat),Number(n.lon)],Math.max(O.getZoom(),11),{duration:.6}))}))}));case 82:if(window.L){e.next=85;break}return a.innerHTML='<p role="alert">Leaflet belum dimuat. Tambahkan CDN Leaflet JS di index.html.</p>',e.abrupt("return");case 85:return a._leaflet_id&&a.replaceWith(a.cloneNode(!0)),S=document.getElementById("homeMap"),P=c.find((function(e){return Number.isFinite(Number(e.lat))&&Number.isFinite(Number(e.lon))})),T=P?[Number(P.lat),Number(P.lon)]:[-2.5489,118.0149],O=L.map(S).setView(T,P?11:5),L.tileLayer((null===h.A||void 0===h.A||null===(t=h.A.MAP)||void 0===t?void 0:t.TILE_URL)||"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:(null===h.A||void 0===h.A||null===(n=h.A.MAP)||void 0===n?void 0:n.ATTRIBUTION)||"&copy; OpenStreetMap"}).addTo(O),E=L.featureGroup().addTo(O),c.forEach((function(e,t){var n,r,a,i,c=Number(e.lat),u=Number(e.lon);if(Number.isFinite(c)&&Number.isFinite(u)){var s='\n        <div style="min-width:200px">\n          <img src="'.concat(e.photoUrl,'" alt="').concat(e.name?"".concat(Tt(Ot,A,_t).call(A,e.name)," - ").concat(Tt(Ot,A,_t).call(A,null!==(n=e.description)&&void 0!==n?n:"Foto story")):Tt(Ot,A,_t).call(A,null!==(r=e.description)&&void 0!==r?r:"Foto story"),'"\n               style="width:100%;height:100px;object-fit:cover;border-radius:8px;margin-bottom:8px" />\n          <strong>').concat(Tt(Ot,A,_t).call(A,null!==(a=e.name)&&void 0!==a?a:"Tanpa Nama"),'</strong><br/>\n          <span style="font-size:12px">').concat(Tt(Ot,A,_t).call(A,(null!==(i=e.description)&&void 0!==i?i:"").slice(0,100))).concat((e.description||"").length>100?"":"",'</span><br/>\n          <span style="font-size:11px;color:#666">').concat(Tt(Ot,A,Lt).call(A,e.createdAt),"</span>\n        </div>\n      "),l=L.marker([c,u]).addTo(E).bindPopup(s),f=o.querySelector('[data-idx="'.concat(t,'"]'));if(f){var p=f.querySelector(".story-body");p&&p.addEventListener("click",(function(){l.openPopup(),O.flyTo([c,u],Math.max(O.getZoom(),11),{duration:.6})}))}}})),E.getLayers().length&&O.fitBounds(E.getBounds(),{padding:[24,24]}),setTimeout((function(){return O.invalidateSize()}),0),e.next=97,Tt(Ot,this,Et).call(this);case 97:k&&setTimeout((function(){var e=o.querySelector('[data-story-id="'.concat(k,'"]'));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.style.border="3px solid #6c63ff",e.style.boxShadow="0 0 10px rgba(108, 99, 255, 0.5)",setTimeout((function(){e.style.border="",e.style.boxShadow=""}),3e3))}),500);case 98:case"end":return e.stop()}}),e,this,[[14,46,65,68],[50,59]])}))),function(){return n.apply(this,arguments)})}],t&&St(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}(),"/about":m,"/favorite":_e,"/login":We,"/register":ct,"/add":new ae};function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Bt(){var e=Ut(),t=e.m(Bt),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,Ct(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Bt=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Rt(e,t)},AsyncIterator:Ht,async:function(e,t,n,o,i){return(r(t)?Dt:Mt)(a(e),t,n,o,i)},keys:Gt,values:Ct}})()}function Ct(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ft(e)+" is not iterable")}function Gt(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Mt(e,t,n,r,o){var a=Dt(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function Dt(e,t,n,r,o){return new Ht(Ut().w(e,t,n,r),o||Promise)}function Ht(e,t){function n(r,o,a,i){try{var c=e[r](o),u=c.value;return u instanceof Rt?t.resolve(u.v).then((function(e){n("next",e,a,i)}),(function(e){n("throw",e,a,i)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,i)}))}catch(e){i(e)}}var r;this.next||(qt(Ht.prototype),qt(Ht.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),qt(this,"_invoke",(function(e,o,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}),!0)}function Ut(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return qt(s,"_invoke",function(n,r,o){var a,c,u,s=0,l=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(t,n){return a=t,c=0,u=e,p.n=n,i}};function d(n,r){for(c=n,u=r,t=0;!f&&s&&!o&&t<l.length;t++){var o,a=l[t],d=p.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=d&&((o=n<2&&d<a[1])?(c=0,p.v=r,p.n=a[1]):d<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,p.n=v,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,v),c=l,u=v;(t=c<2?e:u)||!f;){a||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(f=p.n<0)?u:n.call(r,p))!==i)break}catch(t){a=e,c=1,u=t}finally{s=1}}return{value:t,done:f}}}(n,o,a),!0),s}var i={};function c(){}function u(){}function s(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(qt(t={},r,(function(){return this})),t),f=s.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,qt(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=s,qt(f,"constructor",s),qt(s,"constructor",u),u.displayName="GeneratorFunction",qt(s,o,"GeneratorFunction"),qt(f),qt(f,o,"Generator"),qt(f,r,(function(){return this})),qt(f,"toString",(function(){return"[object Generator]"})),(Ut=function(){return{w:a,m:p}})()}function qt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}qt=function(e,t,n,r){function a(t,n){qt(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},qt(e,t,n,r)}function Rt(e,t){this.v=e,this.k=t}function zt(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function Vt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){zt(a,r,o,i,c,"next",e)}function c(e){zt(a,r,o,i,c,"throw",e)}i(void 0)}))}}function Kt(){var e=document.querySelector("#main-content")||document.querySelector("#main-content");if(!e)throw new Error("Container #main-content tidak ditemukan");return e}function Yt(e,t,n){return Wt.apply(this,arguments)}function Wt(){return(Wt=Vt(Bt().mark((function e(t,n,r){var o,a;return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("#main-content tidak ditemukan");case 2:if(document.startViewTransition){e.next=12;break}if(t.innerHTML="string"==typeof n||null!=n?n:"",e.prev=4,"function"!=typeof r){e.next=8;break}return e.next=8,r();case 8:return e.prev=8,window.scrollTo({top:0,behavior:"auto"}),e.finish(8);case 11:return e.abrupt("return");case 12:return o=document.startViewTransition(Vt(Bt().mark((function e(){return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.innerHTML="string"==typeof n||null!=n?n:"";case 1:case"end":return e.stop()}}),e)})))),e.prev=13,e.next=16,o.finished;case 16:if((a=t.querySelector('h1, [role="heading"]'))&&(a.setAttribute("tabindex","-1"),a.focus()),"function"!=typeof r){e.next=21;break}return e.next=21,r();case 21:return e.prev=21,window.scrollTo({top:0,behavior:"auto"}),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[4,,8,11],[13,,21,24]])})))).apply(this,arguments)}var Jt=function(e){return function(){return'\n  <section class="container">\n    <h1>'.concat(e,"</h1>\n    <p>Halaman ini belum diimplementasikan.</p>\n  </section>\n")}},Zt=function(){return'\n  <section class="container">\n    <h1>404</h1>\n    <p>Halaman tidak ditemukan.</p>\n  </section>\n'};function $t(){var e=document.getElementById("drawer-button"),t=document.getElementById("navigation-drawer");if(e&&t){e.addEventListener("click",(function(){return t.classList.toggle("open")})),t.addEventListener("click",(function(e){e.target.matches('a[href^="#"]')&&t.classList.remove("open")}));var n=document.getElementById("logout-link");n&&n.addEventListener("click",(function(e){e.preventDefault(),localStorage.removeItem("authToken"),Xt(),"#/home"!==location.hash?location.hash="#/home":location.reload()})),Xt()}}function Xt(){var e=localStorage.getItem("authToken"),t=document.querySelector(".login-nav"),n=document.querySelector(".register-nav"),r=document.querySelector(".logout-nav");e?(t&&(t.style.display="none"),n&&(n.style.display="none"),r&&(r.style.display="block")):(t&&(t.style.display="block"),n&&(n.style.display="block"),r&&(r.style.display="none"))}var Qt=!1,en=null;function tn(){return nn.apply(this,arguments)}function nn(){return(nn=Vt(Bt().mark((function e(){var t,n,r,o,a;return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Kt(),void 0,void 0,i=(window.location.hash||"").slice(1).toLowerCase().split("/").filter(Boolean),c="/".concat(i[0]||""),r="/"===c?"/home":c,!Qt||en!==r){e.next=5;break}return console.debug("[router] Already rendering",r,"- skipping"),e.abrupt("return");case 5:if(en!==r||!Qt){e.next=7;break}return e.abrupt("return");case 7:if(Qt=!0,en=r,o=null==Nt?void 0:Nt[r],"/home"===r&&"function"==typeof o?o=new o:"/add"===r&&o&&"function"==typeof o.render||"/favorite"===r&&"function"==typeof o&&(o=new o),o||(o=["/about","/add","/favorite","/login","/register"].includes(r)?Jt(r.replace("/","").toUpperCase()):Zt),"function"==typeof o||o&&"function"==typeof o.render||(console.warn("[router] handler tidak valid  NotFound",r,o),o=Zt),console.debug("[router] navigate ",r,"handler:",o.name||(null===(t=o.constructor)||void 0===t?void 0:t.name)||"(anon)"),!o||"function"!=typeof o.render){e.next=21;break}return e.next=18,Promise.resolve(o.render());case 18:a=e.sent,e.next=28;break;case 21:if("function"!=typeof o){e.next=27;break}return e.next=24,Promise.resolve(o());case 24:a=e.sent,e.next=28;break;case 27:a="";case 28:return e.prev=28,e.next=31,Yt(n,a,Vt(Bt().mark((function e(){var t;return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o||"function"!=typeof o.afterRender){e.next=12;break}return console.debug("[router] run afterRender:",o.name||(null===(t=o.constructor)||void 0===t?void 0:t.name)||"(anon)"),e.prev=2,e.next=5,o.afterRender();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("[router] afterRender error:",e.t0);case 10:e.next=25;break;case 12:if("function"!=typeof o.afterRender){e.next=24;break}return console.debug("[router] run afterRender:",o.name||"(anon)"),e.prev=14,e.next=17,o.afterRender();case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(14),console.error("[router] afterRender error:",e.t1);case 22:e.next=25;break;case 24:console.debug("[router] no afterRender for",r);case 25:case"end":return e.stop()}}),e,null,[[2,7],[14,19]])}))));case 31:return e.prev=31,Qt=!1,setTimeout((function(){en===r&&(en=null)}),1e3),e.finish(31);case 35:case"end":return e.stop()}var i,c}),e,null,[[28,,31,35]])})))).apply(this,arguments)}var rn=null;function on(){return an.apply(this,arguments)}function an(){return(an=Vt(Bt().mark((function e(){var t,n,r;return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(rn){e.next=3;break}return console.log("[PWA] No install prompt available"),e.abrupt("return");case 3:return rn.prompt(),e.next=6,rn.userChoice;case 6:t=e.sent,n=t.outcome,console.log("[PWA] User response to install prompt:",n),rn=null,(r=document.getElementById("pwa-install-btn"))&&(r.style.display="none");case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cn(){return un.apply(this,arguments)}function un(){return(un=Vt(Bt().mark((function e(){var t,n,r,o;return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=17;break}return e.prev=1,t=location.pathname,n="",t.includes("/Tugas-intermediate-idelia-fk")&&(n="/Tugas-intermediate-idelia-fk"),r="".concat(n,"/sw.js"),console.log("[main] Registering Service Worker:",r),e.next=9,navigator.serviceWorker.register(r);case 9:o=e.sent,console.log("[main] Service Worker registered successfully:",o),o.addEventListener("updatefound",(function(){var e=o.installing;e.addEventListener("statechange",(function(){"installed"===e.state&&navigator.serviceWorker.controller&&console.log("[main] New service worker available")}))})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.error("[main] Service Worker registration failed:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}window.addEventListener("beforeinstallprompt",(function(e){console.log("[PWA] beforeinstallprompt event fired"),e.preventDefault(),rn=e,function(){if(window.matchMedia("(display-mode: standalone)").matches)console.log("[PWA] App already installed");else{var e=document.getElementById("pwa-install-btn");e||((e=document.createElement("button")).id="pwa-install-btn",e.innerHTML=" Install App",e.style.cssText="\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      padding: 12px 24px;\n      background: #6c63ff;\n      color: white;\n      border: none;\n      border-radius: 8px;\n      cursor: pointer;\n      font-size: 16px;\n      font-weight: bold;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      z-index: 1000;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n    ",e.addEventListener("click",on),document.body.appendChild(e)),e.style.display="block"}}()})),window.addEventListener("appinstalled",(function(){console.log("[PWA] App installed successfully"),rn=null;var e=document.getElementById("pwa-install-btn");e&&(e.style.display="none")})),window.addEventListener("load",Vt(Bt().mark((function e(){return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cn();case 2:return e.prev=2,e.next=5,o.e(84).then(o.bind(o,84));case 5:(0,e.sent.setupAutoSync)(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.warn("[main] Sync setup failed:",e.t0);case 13:if(location.hash){e.next=17;break}return location.replace("#/home"),setTimeout((function(){$t(),tn().catch(console.error)}),0),e.abrupt("return");case 17:$t(),tn().catch(console.error);case 19:case"end":return e.stop()}}),e,null,[[2,10]])}))));var sn=null;window.addEventListener("hashchange",(function(e){var t=location.hash;console.log("[router] Hash changed:",t,"from:",e.oldURL),Xt(),sn&&clearTimeout(sn),sn=setTimeout((function(){tn().catch(console.error),sn=null}),50)}),{passive:!0}),window.updateNavigation=Xt})();